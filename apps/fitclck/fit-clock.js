!function(){var e=require("Storage");var t="ftclog",n=0,a=0,r=null,l=0,o=0,i=new Date,s=Graphics.createArrayBuffer(240,240,1,{msb:!0});var c,u="     ",p="BPM: ";const d={" ":e=>[],0:e=>[[e,0,1,0],[1,0,1,1],[1,1,1,2],[e,2,1,2],[e,1,e,2],[e,0,e,1]],1:e=>[[1-e,0,1,0],[1,0,1,1],[1-e,1,1,1],[1-e,1,1-e,2],[1-e,2,1,2]],2:e=>[[0,0,1,0],[1,0,1,1],[0,1,1,1],[0,1+e,0,2],[1,2-e,1,2],[0,2,1,2]],3:e=>[[0,0,1-e,0],[0,0,0,e],[1,0,1,1],[0,1,1,1],[1,1,1,2],[e,2,1,2]],4:e=>[[0,0,0,1],[1,0,1-e,0],[1,0,1,1-e],[0,1,1,1],[1,1,1,2],[1-e,2,1,2]],5:(e,t)=>t?[[0,0,0,1],[0,0,1,0],[e,1,1,1],[1,1,1,2],[0,2,1,2],[0,2,0,2],[1,1-e,1,1],[0,1,0,1+e]]:[[0,0,0,1],[0,0,1,0],[0,1,1,1],[1,1,1,2],[0,2,1,2],[0,2-e,0,2]],6:e=>[[0,0,0,1-e],[0,0,1,0],[e,1,1,1],[1,1-e,1,1],[1,1,1,2],[e,2,1,2],[0,1-e,0,2-2*e]],7:e=>[[0,0,0,e],[0,0,1,0],[1,0,1,1],[1-e,1,1,1],[1,1,1,2],[1-e,2,1,2],[1-e,1,1-e,2]],8:e=>[[0,0,0,1],[0,0,1,0],[1,0,1,1],[0,1,1,1],[1,1,1,2],[0,2,1,2],[0,1,0,2-e]],9:e=>[[0,0,0,1],[0,0,1,0],[1,0,1,1],[0,1,1-e,1],[0,1,0,1+e],[1,1,1,2],[0,2,1,2]],":":e=>[[.4,.4,.6,.4],[.6,.4,.6,.6],[.6,.6,.4,.6],[.4,.4,.4,.6],[.4,1.4,.6,1.4],[.6,1.4,.6,1.6],[.6,1.6,.4,1.6],[.4,1.4,.4,1.6]]};function f(e,t,l){s.clear();var i=1;var c=2;const u=34;for(var f=0;f<e.length;f++){var w=e[f],B=t[f];":"==B&&(i-=4);var S,v=l;void 0!==w&&(B-1==w||0==B&&5==w||0==B&&9==w)?S=w:(S=B,v=0),d[S](v,5==w&&0==B).forEach(e=>{e[0]!=e[2]?s.fillRect(i+e[0]*u,c+e[1]*u-2,i+e[2]*u,c+e[3]*u+2):e[1]!=e[3]&&s.fillRect(i+e[0]*u-2,c+e[1]*u,i+e[2]*u+2,c+e[3]*u)}),":"==B&&(i-=4),i+=43}c+=68;var A=new Date;s.setFont("6x8"),s.setFontAlign(-1,-1),s.drawString(("0"+A.getSeconds()).substr(-2),i,c-8),s.setFontAlign(0,-1);var F=A.toString().substr(0,15);s.drawString(F,s.getWidth()/2,c+8),1==n&&(s.setFont("6x8"),s.setFontVector(12),s.setFontAlign(0,-1),s.drawString(p,s.getWidth()/2,c+24)),1==a&&(s.setFont("6x8"),s.setFontVector(12),s.setFontAlign(0,-1),s.drawString("GPS ON",s.getWidth()/2,c+40),null!=r&&r.satellites>0&&(s.setFont("6x8"),s.setFontAlign(0,-1),s.drawString(r.satellites+" satellites",s.getWidth()/2,c+56))),o>0&&(s.setFont("6x8"),s.setFontAlign(0,-1),s.drawString("Steps "+o,s.getWidth()/2,c+64)),g.setColor(1,1,1),g.drawImage({width:s.getWidth(),height:s.getHeight(),buffer:s.buffer},0,50)}function w(){if(Bangle.isLCDOn()&&!c){var e=new Date,t=(" "+e.getHours()).substr(-2)+":"+("0"+e.getMinutes()).substr(-2),n=u;if(t!=n){var a=0;c=setInterval((function(){(a+=.1)>=1&&(a=1,clearInterval(c),c=0),f(n,t,a)}),20),u=t}else f(t,n,0)}}function B(e){var t=e.toUTCString().split(" ");return t[4].substr(0,5)+" - "+[t[0],t[1],t[2]].join(" ")}function S(e){null==Bangle.AppLog.currentFile&&(console.log("Trying to create new file"+t),Bangle.AppLog.init(t));try{Bangle.AppLog.write(e)}catch(e){console.log(e),e.message.startsWith("Unable to find or create")&&Bangle.AppLog.init(t)}}function v(){n=0===n?1:0,Bangle.setHRMPower(n)}function A(){a=0===a?1:0,Bangle.setGPSPower(a)}Bangle.on("lcdPower",(function(e){e&&(w(),Bangle.drawWidgets())})),Bangle.on("step",(function(e){var t=new Date;i.getDate()==t.getDate()?o++:o=1,i=t;var n=Bangle.getAccel();S(`"ACCL","${B(new Date)}","${n.x}","${n.y}","${n.z}","${n.diff}","${n.mag}"`)})),Bangle.on("GPS",(function(e){(r=e).satellites>0&&l<180?(l=0,setTime(r.time.getTime()/1e3),S(`"GPS","${B(new Date)}","${r.satellites}","${r.lat}","${r.lon}","${r.alt}","${r.speed}","${r.course}","${r.time.ms}"`)):++l>=180&&(l=0,a=0,Bangle.setGPSPower(a))})),Bangle.on("HRM",(function(e){p="BPM: "+e.bpm,S(`"HRM","${B(new Date)}","${e.bpm}","${e.confidence}"`)})),E.on("kill",()=>{let e={lastUpdate:i.toISOString(),stepsToday:o};require("Storage").write("@fitclck",e)}),Bangle.AppLog={currentFile:null,lock:!1,init:t=>{try{null!=t&&""!=t?Bangle.AppLog.currentFile=e.open(t,"a"):console.error("Log file name not provided")}catch(e){console.log("Failed to create file",e)}},write:e=>{1!=Bangle.AppLog.lock&&Bangle.AppLog.currentFile.write(e+"\n")},clearLog:()=>{Bangle.AppLog.lock=!0,Bangle.AppLog.currentFile=null,require("Storage").open("ftclog","w").erase(),Bangle.AppLog.lock=!1,load()}},g.clear(),function(){let e=require("Storage").readJSON("@fitclck");e&&(e.lastUpdate&&(i=new Date(e.lastUpdate)),o=0|e.stepsToday)}(),setInterval(w,1e3),w(),a=1,Bangle.setGPSPower(a),n=1,Bangle.setHRMPower(n),setWatch(v,BTN1,{repeat:!0}),setWatch(A,BTN3,{repeat:!0}),Bangle.loadWidgets(),Bangle.drawWidgets()}();